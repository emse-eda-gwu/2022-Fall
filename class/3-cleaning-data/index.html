<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Cleaning Data</title>
    <meta charset="utf-8" />
    <meta name="author" content="John Paul Helveston" />
    <meta name="date" content="2022-09-14" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <meta name="description" content="EMSE 4575: Exploratory Data Analysis"/>
    <meta name="generator" content="xaringan and remark.js"/>
    <meta name="github-repo" content="emse-eda-gwu/2022-Spring"/>
    <meta name="twitter:title" content="Cleaning Data"/>
    <meta name="twitter:description" content="EMSE 4575: Exploratory Data Analysis"/>
    <meta name="twitter:url" content="https://eda.seas.gwu.edu/2022-Spring/"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:creator" content="@johnhelveston"/>
    <meta name="twitter:site" content="@johnhelveston"/>
    <meta property="og:title" content="Cleaning Data"/>
    <meta property="og:description" content="EMSE 4575: Exploratory Data Analysis"/>
    <meta property="og:url" content="https://eda.seas.gwu.edu/2022-Spring/"/>
    <meta property="og:type" content="website"/>
    <meta property="og:locale" content="en_US"/>
    <meta property="article:author" content="John Paul Helveston"/>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="css/lexis.css" type="text/css" />
    <link rel="stylesheet" href="css/lexis-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">




class: middle, inverse

.leftcol30[

&lt;center&gt;
&lt;img src="https://raw.githubusercontent.com/emse-eda-gwu/2022-Fall/master/images/logo.png" width=250&gt;
&lt;/center&gt;

]

.rightcol70[

# Week 3: .fancy[Cleaning Data]

### <svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M243.4 2.587C251.4-.8625 260.6-.8625 268.6 2.587L492.6 98.59C506.6 104.6 514.4 119.6 511.3 134.4C508.3 149.3 495.2 159.1 479.1 160V168C479.1 181.3 469.3 192 455.1 192H55.1C42.74 192 31.1 181.3 31.1 168V160C16.81 159.1 3.708 149.3 .6528 134.4C-2.402 119.6 5.429 104.6 19.39 98.59L243.4 2.587zM256 128C273.7 128 288 113.7 288 96C288 78.33 273.7 64 256 64C238.3 64 224 78.33 224 96C224 113.7 238.3 128 256 128zM127.1 416H167.1V224H231.1V416H280V224H344V416H384V224H448V420.3C448.6 420.6 449.2 420.1 449.8 421.4L497.8 453.4C509.5 461.2 514.7 475.8 510.6 489.3C506.5 502.8 494.1 512 480 512H31.1C17.9 512 5.458 502.8 1.372 489.3C-2.715 475.8 2.515 461.2 14.25 453.4L62.25 421.4C62.82 420.1 63.41 420.6 63.1 420.3V224H127.1V416z"/></svg> EMSE 4575: Exploratory Data Analysis
### <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M224 256c70.7 0 128-57.31 128-128s-57.3-128-128-128C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3C77.61 304 0 381.6 0 477.3c0 19.14 15.52 34.67 34.66 34.67h378.7C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304z"/></svg> John Paul Helveston
### <svg aria-hidden="true" role="img" viewBox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:white;overflow:visible;position:relative;"><path d="M96 32C96 14.33 110.3 0 128 0C145.7 0 160 14.33 160 32V64H288V32C288 14.33 302.3 0 320 0C337.7 0 352 14.33 352 32V64H400C426.5 64 448 85.49 448 112V160H0V112C0 85.49 21.49 64 48 64H96V32zM448 464C448 490.5 426.5 512 400 512H48C21.49 512 0 490.5 0 464V192H448V464z"/></svg> September 14, 2022

]

---

class: center, middle, inverse

# .fancy[.blue[Tip of the week]]

## Copy-paste magic with [`datapasta`](https://milesmcbain.github.io/datapasta/)

&lt;br&gt;

### **Useful for "small data"**: e.g., [U.S. State Abbreviations](https://www.50states.com/abbreviations.htm)

---

## Today's data

"Clean" data


```r
wildlife_impacts &lt;- read_csv(here::here('data', 'wildlife_impacts.csv'))
milk_production &lt;- read_csv(here::here('data', 'milk_production.csv'))
msleep &lt;- read_csv(here::here('data', 'msleep.csv'))
```

"Messy" data


```r
wind &lt;- read_excel(here::here('data', 'US_State_Wind_Energy_Facts_2018.xlsx'))
hot_dogs &lt;- read_excel(here::here('data', 'hot_dog_winners.xlsx'))
```

---

## Plus two new packages:


```r
# For manipulating dates
install.packages('lubridate')

# For cleaning column names
install.packages('janitor')
```

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. Merging datasets with joins
### 2. Are your variables the right _type_?
### 3. Are your variables the right _name_?

### QUIZ 1

### 4. Re-coding variables
### 5. Dates
### 6. Dealing with messy Excel files

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. .orange[Merging datasets with joins]
### 2. Are your variables the right _type_?
### 3. Are your variables the right _name_?

### QUIZ 1

### 4. Re-coding variables
### 5. Dates
### 6. Dealing with messy Excel files

---

.leftcol[

&lt;center&gt;
&lt;img src="images/join_fail.jpg" height=600&gt;
&lt;/center&gt;

]

.rightcol[

## .center[What's wrong with this map?]

]

---

### Likely culprit: Merging two columns

.leftcol[



```r
head(names)
```

```
#&gt;   state_name
#&gt; 1    Alabama
#&gt; 2     Alaska
#&gt; 3    Arizona
#&gt; 4   Arkansas
#&gt; 5 California
#&gt; 6   Colorado
```

```r
head(abbs)
```

```
#&gt;   state_abb
#&gt; 1        AK
#&gt; 2        AL
#&gt; 3        AR
#&gt; 4        AZ
#&gt; 5        CA
#&gt; 6        CO
```

]

--

.rightcol[


```r
result &lt;- bind_cols(names, abbs)
head(result)
```

```
#&gt;   state_name state_abb
#&gt; 1    Alabama        AK
#&gt; 2     Alaska        AL
#&gt; 3    Arizona        AR
#&gt; 4   Arkansas        AZ
#&gt; 5 California        CA
#&gt; 6   Colorado        CO
```

]

---

## Joins

1. `inner_join()`
2. `left_join()` / `right_join()`
3. `full_join()`

--

Example: `band_members` &amp; `band_instruments`

.leftcol[


```r
band_members
```

```
#&gt; # A tibble: 3 × 2
#&gt;   name  band   
#&gt;   &lt;chr&gt; &lt;chr&gt;  
#&gt; 1 Mick  Stones 
#&gt; 2 John  Beatles
#&gt; 3 Paul  Beatles
```

]

.rightcol[


```r
band_instruments
```

```
#&gt; # A tibble: 3 × 2
#&gt;   name  plays 
#&gt;   &lt;chr&gt; &lt;chr&gt; 
#&gt; 1 John  guitar
#&gt; 2 Paul  bass  
#&gt; 3 Keith guitar
```

]

---

.leftcol[

## `inner_join()`


```r
band_members %&gt;%
    inner_join(band_instruments)
```

```
#&gt; # A tibble: 2 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 John  Beatles guitar
#&gt; 2 Paul  Beatles bass
```

]

.rightcol[

&lt;br&gt;
&lt;center&gt;
&lt;img src="images/inner_join.gif"&gt;
&lt;/center&gt;

]

---

.leftcol[

## `full_join()`


```r
band_members %&gt;%
    full_join(band_instruments)
```

```
#&gt; # A tibble: 4 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 Mick  Stones  &lt;NA&gt;  
#&gt; 2 John  Beatles guitar
#&gt; 3 Paul  Beatles bass  
#&gt; 4 Keith &lt;NA&gt;    guitar
```

]

.rightcol[

&lt;br&gt;
&lt;center&gt;
&lt;img src="images/full_join.gif"&gt;
&lt;/center&gt;

]

---

.leftcol[

## `left_join()`


```r
band_members %&gt;%
    left_join(band_instruments)
```

```
#&gt; # A tibble: 3 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 Mick  Stones  &lt;NA&gt;  
#&gt; 2 John  Beatles guitar
#&gt; 3 Paul  Beatles bass
```

]

.rightcol[

&lt;br&gt;
&lt;center&gt;
&lt;img src="images/left_join.gif"&gt;
&lt;/center&gt;

]

---

.leftcol[

## `right_join()`


```r
band_members %&gt;%
    right_join(band_instruments)
```

```
#&gt; # A tibble: 3 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 John  Beatles guitar
#&gt; 2 Paul  Beatles bass  
#&gt; 3 Keith &lt;NA&gt;    guitar
```

]

.rightcol[

&lt;br&gt;
&lt;center&gt;
&lt;img src="images/right_join.gif"&gt;
&lt;/center&gt;

]

---

## Specify the joining variable name

.leftcol[


```r
band_members %&gt;%
    left_join(band_instruments)
```

```
#&gt; Joining, by = "name"
```

```
#&gt; # A tibble: 3 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 Mick  Stones  &lt;NA&gt;  
#&gt; 2 John  Beatles guitar
#&gt; 3 Paul  Beatles bass
```

]

.rightcol[


```r
band_members %&gt;%
    left_join(band_instruments,
*             by = 'name')
```

```
#&gt; # A tibble: 3 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 Mick  Stones  &lt;NA&gt;  
#&gt; 2 John  Beatles guitar
#&gt; 3 Paul  Beatles bass
```

]

---

## Specify the joining variable name

If the names differ, use `by = c("left_name" = "joining_name")`

.leftcol[


```r
band_members
```

```
#&gt; # A tibble: 3 × 2
#&gt;   name  band   
#&gt;   &lt;chr&gt; &lt;chr&gt;  
#&gt; 1 Mick  Stones 
#&gt; 2 John  Beatles
#&gt; 3 Paul  Beatles
```

```r
band_instruments2
```

```
#&gt; # A tibble: 3 × 2
#&gt;   artist plays 
#&gt;   &lt;chr&gt;  &lt;chr&gt; 
#&gt; 1 John   guitar
#&gt; 2 Paul   bass  
#&gt; 3 Keith  guitar
```

]

--

.rightcol[


```r
band_members %&gt;%
    left_join(band_instruments2,
*             by = c("name" = "artist"))
```

```
#&gt; # A tibble: 3 × 3
#&gt;   name  band    plays 
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 Mick  Stones  &lt;NA&gt;  
#&gt; 2 John  Beatles guitar
#&gt; 3 Paul  Beatles bass
```

]

---

## Specify the joining variable name

Or just rename the joining variable in a pipe

.leftcol[


```r
band_members
```

```
#&gt; # A tibble: 3 × 2
#&gt;   name  band   
#&gt;   &lt;chr&gt; &lt;chr&gt;  
#&gt; 1 Mick  Stones 
#&gt; 2 John  Beatles
#&gt; 3 Paul  Beatles
```

```r
band_instruments2
```

```
#&gt; # A tibble: 3 × 2
#&gt;   artist plays 
#&gt;   &lt;chr&gt;  &lt;chr&gt; 
#&gt; 1 John   guitar
#&gt; 2 Paul   bass  
#&gt; 3 Keith  guitar
```

]

.rightcol[


```r
band_members %&gt;%
*   rename(artist = name) %&gt;%
    left_join(band_instruments2,
*             by = "artist")
```

```
#&gt; # A tibble: 3 × 3
#&gt;   artist band    plays 
#&gt;   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; 
#&gt; 1 Mick   Stones  &lt;NA&gt;  
#&gt; 2 John   Beatles guitar
#&gt; 3 Paul   Beatles bass
```

]

---

class: inverse

<div class="countdown" id="timer_5b6a61c0" data-warn-when="15" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">15</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

## Your turn

.leftcol[.font80[

1) Create a data frame called `state_data` by joining the data frames `states_abbs` and `milk_production` and then selecting the variables `region`, `state_name`, `state_abb`. **Hint**: Use the `distinct()` function to drop repeated rows.

Your result should look like this:

.code70[



```r
head(state_data)
```

```
#&gt; # A tibble: 6 × 3
#&gt;   region    state_name    state_abb
#&gt;   &lt;chr&gt;     &lt;chr&gt;         &lt;chr&gt;    
#&gt; 1 Northeast Maine         ME       
#&gt; 2 Northeast New Hampshire NH       
#&gt; 3 Northeast Vermont       VT       
#&gt; 4 Northeast Massachusetts MA       
#&gt; 5 Northeast Rhode Island  RI       
#&gt; 6 Northeast Connecticut   CT
```

]]]

--

.rightcol[.font80[

2) Join the `state_data` data frame to the `wildlife_impacts` data frame, adding the variables `region` and `state_name`



.code50[


```r
glimpse(wildlife_impacts)
```

```
#&gt; Rows: 56,978
#&gt; Columns: 24
#&gt; $ region                &lt;chr&gt; "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast…
#&gt; $ state_name            &lt;chr&gt; "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "Maine", "M…
#&gt; $ state_abb             &lt;chr&gt; "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "ME", "M…
#&gt; $ incident_date         &lt;dttm&gt; 2018-10-23, 2018-10-07, 2018-10-05, 2018-10-05, 2017-07-25, 2016-11-07, 2016-11-07, 2016-10-29, 2016-07-30, 1990-08-01, 2018-11-06, 2018-07-29, 2018-05-05, 2017-04-04, 2016-04-28, 2012-05-20, 2011-10-23, 2003-09-07, 2…
#&gt; $ airport_id            &lt;chr&gt; "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KPWM", "KBGR", "KPWM", "KBGR", "KPWM", "KPWM", "KPWM", "K…
#&gt; $ airport               &lt;chr&gt; "PORTLAND INTL JETPORT (ME)", "PORTLAND INTL JETPORT (ME)", "PORTLAND INTL JETPORT (ME)", "PORTLAND INTL JETPORT (ME)", "PORTLAND INTL JETPORT (ME)", "PORTLAND INTL JETPORT (ME)", "PORTLAND INTL JETPORT (ME)", "PORTLAN…
#&gt; $ operator              &lt;chr&gt; "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "AMERICAN AIRLINES", "DELTA A…
#&gt; $ atype                 &lt;chr&gt; "A-320", "A-319", "A-319", "EMB-190", "EMB-170", "A-319", "A-319", "A-319", "CRJ100/200", "DHC8 DASH 8", "MD-90-30", "MD-90-30", "MD-90-30", "CRJ700", "MD-88", "MD-88", "MD-88", "MD-88", "MD-88", "MD-80", "MD-88", "MD-…
#&gt; $ type_eng              &lt;chr&gt; "D", "D", "D", "D", "D", "D", "D", "D", "D", "C", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D", "D"…
#&gt; $ species_id            &lt;chr&gt; "UNKBS", "ZX302", "ZS010", "I1102", "K3310", "YH004", "UNKB", "YL001", "UNKB", "NE1", "R2001", "YM1102", "NE101", "YL001", "UNKB", "NE1", "UNKB", "I1102", "UNKBS", "NE1", "NE101", "ZX202", "ZX3", "ZX202", "NE1", "UNKBS…
#&gt; $ species               &lt;chr&gt; "Unknown bird - small", "Swamp sparrow", "Blackpoll warbler", "Great blue heron", "Sharp-shinned hawk", "Horned lark", "Unknown bird", "European starling", "Unknown bird", "Gulls", "Snowy owl", "American crow", "Herrin…
#&gt; $ damage                &lt;chr&gt; "N", NA, "N", "M?", "N", "N", "N", "N", "N", "N", NA, "N", "N", NA, "N", NA, "N", NA, NA, "N", "M", "N", "N", "N", "N", "N", "N", "N", "N", "N", NA, "N", "N", "N", "N", "N", "N", "N", "N", "N", "N", "N", "N", "N", "N",…
#&gt; $ num_engs              &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 2, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…
#&gt; $ incident_month        &lt;dbl&gt; 10, 10, 10, 10, 7, 11, 11, 10, 7, 8, 11, 7, 5, 4, 4, 5, 10, 9, 8, 6, 6, 11, 11, 11, 10, 5, 10, 8, 11, 9, 11, 10, 11, 11, 10, 10, 10, 9, 11, 7, 6, 6, 6, 6, 9, 8, 6, 5, 11, 7, 8, 9, 5, 5, 10, 2, 9, 8, 3, 3, 3, 11, 11, 11…
#&gt; $ incident_year         &lt;dbl&gt; 2018, 2018, 2018, 2018, 2017, 2016, 2016, 2016, 2016, 1990, 2018, 2018, 2018, 2017, 2016, 2012, 2011, 2003, 2002, 2000, 2000, 1995, 1995, 1995, 1995, 1995, 1994, 1994, 1993, 1993, 1992, 1990, 2018, 2018, 2018, 2018, 20…
#&gt; $ time_of_day           &lt;chr&gt; NA, "Night", "Night", "Day", "Dawn", "Day", "Day", "Day", "Day", "Day", "Dawn", "Day", "Day", NA, "Night", "Day", NA, "Night", "Day", "Day", "Day", "Day", "Day", "Dawn", "Day", "Day", "Night", "Day", "Day", "Night", "N…
#&gt; $ time                  &lt;dbl&gt; 1310, 1035, 2200, 1645, 645, 1345, 1346, 1400, 1100, NA, 610, 1912, 613, 1145, 2041, 700, NA, 2035, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1515, 1545, 1523, 1610, 1025, 2343, 1533, 1115, 1145, 1130, 11…
#&gt; $ height                &lt;dbl&gt; 15, NA, 1000, 0, 0, 0, 0, NA, NA, 2000, 0, 50, 0, 0, NA, 0, 0, 0, 0, 200, 0, 0, 10, 0, 0, 0, 2500, 0, 3, 200, 0, 0, 5, 20, 0, 10, 0, 800, 0, 50, 0, 0, NA, 1300, 2000, 30, 0, 1300, 2000, 1500, 500, NA, NA, NA, 0, 0, 0, …
#&gt; $ speed                 &lt;dbl&gt; 150, NA, 140, 110, NA, NA, NA, NA, NA, 250, 100, NA, 150, NA, NA, NA, NA, 130, 130, 135, NA, 85, 140, 150, NA, 125, 140, NA, 135, 120, 90, NA, 131, 140, NA, 155, NA, NA, NA, 140, NA, 100, NA, 150, 150, 140, NA, 150, 21…
#&gt; $ phase_of_flt          &lt;chr&gt; "departure", "arrival", "arrival", "arrival", "arrival", "arrival", "arrival", "arrival", "arrival", "departure", "departure", "departure", "departure", "arrival", "arrival", "departure", "arrival", "arrival", "departu…
#&gt; $ sky                   &lt;chr&gt; "Overcast", "Some Cloud", "Some Cloud", "Some Cloud", "Some Cloud", "No Cloud", NA, "Overcast", "Overcast", NA, "Overcast", "Some Cloud", "Some Cloud", "Overcast", NA, "No Cloud", NA, "Overcast", "Overcast", "Overcast"…
#&gt; $ precip                &lt;chr&gt; "None", "None", "None", "None", "None", "None", NA, "Rain", "None", NA, "Rain", "None", "None", "Rain", NA, "None", NA, NA, "None", "None", "None", "None", "None", "None", "None", "None", "Rain", "None", "None", "None"…
#&gt; $ cost_repairs_infl_adj &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 5400, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
#&gt; $ weekday_name          &lt;ord&gt; Tue, Sun, Fri, Fri, Tue, Mon, Mon, Sat, Sat, Wed, Tue, Sun, Sat, Tue, Thu, Sun, Sun, Sun, Fri, Tue, Tue, Tue, Mon, Sat, Tue, Mon, Sat, Tue, Thu, Sat, Tue, Fri, Fri, Sat, Tue, Sat, Wed, Tue, Thu, Thu, Sun, Sun, Sun, Fri…
```

]]]

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. Merging datasets with joins
### 2. .orange[Are your variables the right _type_?]
### 3. Are your variables the right _name_?

### QUIZ 1

### 4. Re-coding variables
### 5. Dates
### 6. Dealing with messy Excel files

---

## Using the `col_types` argument

- You can change the column type when reading in data
- Different syntax for [`readxl::read_excel()`](https://readxl.tidyverse.org/articles/cell-and-column-types.html) and [`readr::read_csv()`](https://readr.tidyverse.org/)

---

.leftcol35[

### `readxl::read_excel()`

`col_types` must be a vector describing each column type

]

.rightcol65[

&lt;br&gt;&lt;br&gt;


```r
wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx'))

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ Ranking                         &lt;chr&gt; "1.0", "2.0", "3.0", "4.0", "5.0", "6.0", "7.0", "8.0", "9.0", "10.0", "11.0", "12.0", "13.0", "14.0", "15.0", "16.0", "17.0", "18.0", "19.0", "20.0", "21.0", "22.0", "23.0", "24.0", "25.0", "26.0", "27.0", "…
#&gt; $ State                           &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNS…
#&gt; $ `Installed Capacity (MW)`       &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9,…
#&gt; $ `Equivalent Homes Powered`      &lt;chr&gt; "6235000.0", "2268000.0", "1935000.0", "1298000.0", "1719000.0", "1050000.0", "1012000.0", "604600.0", "889100.0", "695300.0", "1021000.0", "440700.0", "471700.0", "366500.0", "422100.0", "408700.0", "486700.…
#&gt; $ `Total Investment ($ Millions)` &lt;chr&gt; "42000.0", "13700.0", "14200.0", "12600.0", "9400.0", "8900.0", "7100.0", "6600.0", "6000.0", "6100.0", "5800.0", "4500.0", "3500.0", "3700.0", "2900.0", "3100.0", "2600.0", "2800.0", "2100.0", "2100.0", "180…
#&gt; $ `Wind Projects Online`          &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ `# of Wind Turbines`            &lt;chr&gt; "12750.0", "3717.0", "4145.0", "6972.0", "2795.0", "2632.0", "2428.0", "1868.0", "1949.0", "1725.0", "1611.0", "1203.0", "1051.0", "1052.0", "1005.0", "1005.0", "789.0", "726.0", "583.0", "541.0", "499.0", "3…
```

]

---

.leftcol40[

### `readxl::read_excel()`

`col_types` must be a vector describing each column type

&lt;br&gt;

.font80[

| How it is in Excel | How it will be in R | How to request in `col_types` |
|:--------------------|:-----------------------|:--------------------|
| *anything*          | *non-existent*         | `"skip"`            |
| empty               | `logical`, but all `NA` | *you cannot request this* |
| boolean            | `logical`               | `"logical"`         |
| numeric            | `numeric`               | `"numeric"`         |
| datetime           | `POSIXct`               | `"date"`            |
| text               | `character`             | `"text"`            |
| *anything*         | `list`                  | `"list"`            |

]]

.rightcol60[


```r
columns &lt;- c('numeric', 'text', rep('numeric', 5))
columns
```

```
#&gt; [1] "numeric" "text"    "numeric" "numeric" "numeric" "numeric" "numeric"
```

```r
wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx'),
* col_types = columns)

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ Ranking                         &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, NA, NA, NA, NA, NA, NA, NA, NA, NA
#&gt; $ State                           &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNS…
#&gt; $ `Installed Capacity (MW)`       &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9,…
#&gt; $ `Equivalent Homes Powered`      &lt;dbl&gt; 6235000, 2268000, 1935000, 1298000, 1719000, 1050000, 1012000, 604600, 889100, 695300, 1021000, 440700, 471700, 366500, 422100, 408700, 486700, 314000, 293100, 228000, 181100, 206500, 142100, 199800, 149300, …
#&gt; $ `Total Investment ($ Millions)` &lt;dbl&gt; 42000, 13700, 14200, 12600, 9400, 8900, 7100, 6600, 6000, 6100, 5800, 4500, 3500, 3700, 2900, 3100, 2600, 2800, 2100, 2100, 1800, 1800, 1500, 1400, 1400, 1200, 851, 573, 330, 412, 397, 374, 306, 300, 236, 126…
#&gt; $ `Wind Projects Online`          &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ `# of Wind Turbines`            &lt;dbl&gt; 12750, 3717, 4145, 6972, 2795, 2632, 2428, 1868, 1949, 1725, 1611, 1203, 1051, 1052, 1005, 1005, 789, 726, 583, 541, 499, 386, 466, 493, 376, 336, 205, 144, 105, 119, 80, 75, 66, 71, 86, 104, 25, 18, 6, 3, 1,…
```

]

---

### `readr::read_csv()`

`col_types` describes individual variables by name using `cols()`

.leftcol60[


```r
milk &lt;- read_csv(here::here(
  'data', 'milk_production.csv'),
* col_types = cols(year = col_character()))

glimpse(milk)
```

```
#&gt; Rows: 2,400
#&gt; Columns: 4
#&gt; $ region        &lt;chr&gt; "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Lake States", "Lake States", "Lake States", "Corn Belt", "Corn Belt", "Corn Belt",…
#&gt; $ state         &lt;chr&gt; "Maine", "New Hampshire", "Vermont", "Massachusetts", "Rhode Island", "Connecticut", "New York", "New Jersey", "Pennsylvania", "Delaware", "Maryland", "Michigan", "Wisconsin", "Minnesota", "Ohio", "Indiana", "Illinois", "Iowa"…
#&gt; $ year          &lt;chr&gt; "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1…
#&gt; $ milk_produced &lt;dbl&gt; 6.1900e+08, 3.5600e+08, 1.9700e+09, 6.5800e+08, 7.5000e+07, 6.6100e+08, 1.0341e+10, 7.3000e+08, 7.1240e+09, 1.3000e+08, 1.5600e+09, 4.6020e+09, 1.8435e+10, 9.6360e+09, 4.4200e+09, 2.3820e+09, 2.8500e+09, 4.6700e+09, 3.0120e+09…
```

]

---

### `readr::read_csv()`

`col_types` describes individual variables by name using `cols()`

&lt;br&gt;

&lt;center&gt;
&lt;img src="images/readr_parse_functions.png" width=800&gt;
&lt;/center&gt;

---

## Other option: Edit types **after** reading in the data

.leftcol[


```r
wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx')) %&gt;%
  mutate(
*   Ranking = as.numeric(Ranking),
*   `Equivalent Homes Powered` = as.numeric(`Equivalent Homes Powered`),
*   `Total Investment ($ Millions)` = as.numeric(`Total Investment ($ Millions)`),
*   `# of Wind Turbines` = as.numeric(`# of Wind Turbines`))

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ Ranking                         &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, NA, NA, NA, NA, NA, NA, NA, NA, NA
#&gt; $ State                           &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNS…
#&gt; $ `Installed Capacity (MW)`       &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9,…
#&gt; $ `Equivalent Homes Powered`      &lt;dbl&gt; 6235000, 2268000, 1935000, 1298000, 1719000, 1050000, 1012000, 604600, 889100, 695300, 1021000, 440700, 471700, 366500, 422100, 408700, 486700, 314000, 293100, 228000, 181100, 206500, 142100, 199800, 149300, …
#&gt; $ `Total Investment ($ Millions)` &lt;dbl&gt; 42000, 13700, 14200, 12600, 9400, 8900, 7100, 6600, 6000, 6100, 5800, 4500, 3500, 3700, 2900, 3100, 2600, 2800, 2100, 2100, 1800, 1800, 1500, 1400, 1400, 1200, 851, 573, 330, 412, 397, 374, 306, 300, 236, 126…
#&gt; $ `Wind Projects Online`          &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ `# of Wind Turbines`            &lt;dbl&gt; 12750, 3717, 4145, 6972, 2795, 2632, 2428, 1868, 1949, 1725, 1611, 1203, 1051, 1052, 1005, 1005, 789, 726, 583, 541, 499, 386, 466, 493, 376, 336, 205, 144, 105, 119, 80, 75, 66, 71, 86, 104, 25, 18, 6, 3, 1,…
```

]

.rightcol[


```r
milk &lt;- read_csv(here::here(
  'data', 'milk_production.csv')) %&gt;%
* mutate(year = as.character(year))

glimpse(milk)
```

```
#&gt; Rows: 2,400
#&gt; Columns: 4
#&gt; $ region        &lt;chr&gt; "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Northeast", "Lake States", "Lake States", "Lake States", "Corn Belt", "Corn Belt", "Corn Belt",…
#&gt; $ state         &lt;chr&gt; "Maine", "New Hampshire", "Vermont", "Massachusetts", "Rhode Island", "Connecticut", "New York", "New Jersey", "Pennsylvania", "Delaware", "Maryland", "Michigan", "Wisconsin", "Minnesota", "Ohio", "Indiana", "Illinois", "Iowa"…
#&gt; $ year          &lt;chr&gt; "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1970", "1…
#&gt; $ milk_produced &lt;dbl&gt; 6.1900e+08, 3.5600e+08, 1.9700e+09, 6.5800e+08, 7.5000e+07, 6.6100e+08, 1.0341e+10, 7.3000e+08, 7.1240e+09, 1.3000e+08, 1.5600e+09, 4.6020e+09, 1.8435e+10, 9.6360e+09, 4.4200e+09, 2.3820e+09, 2.8500e+09, 4.6700e+09, 3.0120e+09…
```

]

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. Merging datasets with joins
### 2. Are your variables the right _type_?
### 3. .orange[Are your variables the right _name_?]

### QUIZ 1

### 4. Re-coding variables
### 5. Dates
### 6. Dealing with messy Excel files

&lt;!--
got the content on select() from Suzan Baert:
https://suzan.rbind.io/2018/01/dplyr-tutorial-1/
--&gt;

---

## Renaming made easy

.leftcol35[.noborder[.center[

`janitor::clean_names()`

&lt;center&gt;
&lt;img src="images/janitor_logo.png" width=200&gt;
&lt;/center&gt;

]]]

--

.rightcol65[


```r
wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx'))

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ Ranking                         &lt;chr&gt; "1.0", "2.0", "3.0", "4.0", "5.0", "6.0", "7.0", "8.0", "9.0", "10.0", "11.0", "12.0", "13.0", "14.0", "15.0", "16.0", "17.0", "18.0", "19.0", "20.0", "21.0", "22.0", "23.0", "24.0", "25.0", "26.0", "27.0", "…
#&gt; $ State                           &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNS…
#&gt; $ `Installed Capacity (MW)`       &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9,…
#&gt; $ `Equivalent Homes Powered`      &lt;chr&gt; "6235000.0", "2268000.0", "1935000.0", "1298000.0", "1719000.0", "1050000.0", "1012000.0", "604600.0", "889100.0", "695300.0", "1021000.0", "440700.0", "471700.0", "366500.0", "422100.0", "408700.0", "486700.…
#&gt; $ `Total Investment ($ Millions)` &lt;chr&gt; "42000.0", "13700.0", "14200.0", "12600.0", "9400.0", "8900.0", "7100.0", "6600.0", "6000.0", "6100.0", "5800.0", "4500.0", "3500.0", "3700.0", "2900.0", "3100.0", "2600.0", "2800.0", "2100.0", "2100.0", "180…
#&gt; $ `Wind Projects Online`          &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ `# of Wind Turbines`            &lt;chr&gt; "12750.0", "3717.0", "4145.0", "6972.0", "2795.0", "2632.0", "2428.0", "1868.0", "1949.0", "1725.0", "1611.0", "1203.0", "1051.0", "1052.0", "1005.0", "1005.0", "789.0", "726.0", "583.0", "541.0", "499.0", "3…
```

]

---

## Renaming made easy

.leftcol35[.noborder[.center[

`janitor::clean_names()`

&lt;center&gt;
&lt;img src="images/janitor_logo.png" width=200&gt;
&lt;/center&gt;

]]]

.rightcol65[


```r
*library(janitor)

wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx')) %&gt;%
* clean_names()

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ ranking                   &lt;chr&gt; "1.0", "2.0", "3.0", "4.0", "5.0", "6.0", "7.0", "8.0", "9.0", "10.0", "11.0", "12.0", "13.0", "14.0", "15.0", "16.0", "17.0", "18.0", "19.0", "20.0", "21.0", "22.0", "23.0", "24.0", "25.0", "26.0", "27.0", "28.0",…
#&gt; $ state                     &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNSYLVANI…
#&gt; $ installed_capacity_mw     &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9, 5, 2,…
#&gt; $ equivalent_homes_powered  &lt;chr&gt; "6235000.0", "2268000.0", "1935000.0", "1298000.0", "1719000.0", "1050000.0", "1012000.0", "604600.0", "889100.0", "695300.0", "1021000.0", "440700.0", "471700.0", "366500.0", "422100.0", "408700.0", "486700.0", "3…
#&gt; $ total_investment_millions &lt;chr&gt; "42000.0", "13700.0", "14200.0", "12600.0", "9400.0", "8900.0", "7100.0", "6600.0", "6000.0", "6100.0", "5800.0", "4500.0", "3500.0", "3700.0", "2900.0", "3100.0", "2600.0", "2800.0", "2100.0", "2100.0", "1800.0", …
#&gt; $ wind_projects_online      &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ number_of_wind_turbines   &lt;chr&gt; "12750.0", "3717.0", "4145.0", "6972.0", "2795.0", "2632.0", "2428.0", "1868.0", "1949.0", "1725.0", "1611.0", "1203.0", "1051.0", "1052.0", "1005.0", "1005.0", "789.0", "726.0", "583.0", "541.0", "499.0", "386.0",…
```

]

---

## Renaming made easy

.leftcol35[.noborder[.center[

`janitor::clean_names()`

&lt;center&gt;
&lt;img src="images/janitor_logo.png" width=200&gt;
&lt;/center&gt;

]]]

.rightcol65[


```r
*library(janitor)

wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx')) %&gt;%
* clean_names(case = 'lower_camel')

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ ranking                 &lt;chr&gt; "1.0", "2.0", "3.0", "4.0", "5.0", "6.0", "7.0", "8.0", "9.0", "10.0", "11.0", "12.0", "13.0", "14.0", "15.0", "16.0", "17.0", "18.0", "19.0", "20.0", "21.0", "22.0", "23.0", "24.0", "25.0", "26.0", "27.0", "28.0", "…
#&gt; $ state                   &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNSYLVANIA"…
#&gt; $ installedCapacityMw     &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9, 5, 2, 0…
#&gt; $ equivalentHomesPowered  &lt;chr&gt; "6235000.0", "2268000.0", "1935000.0", "1298000.0", "1719000.0", "1050000.0", "1012000.0", "604600.0", "889100.0", "695300.0", "1021000.0", "440700.0", "471700.0", "366500.0", "422100.0", "408700.0", "486700.0", "314…
#&gt; $ totalInvestmentMillions &lt;chr&gt; "42000.0", "13700.0", "14200.0", "12600.0", "9400.0", "8900.0", "7100.0", "6600.0", "6000.0", "6100.0", "5800.0", "4500.0", "3500.0", "3700.0", "2900.0", "3100.0", "2600.0", "2800.0", "2100.0", "2100.0", "1800.0", "1…
#&gt; $ windProjectsOnline      &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ numberOfWindTurbines    &lt;chr&gt; "12750.0", "3717.0", "4145.0", "6972.0", "2795.0", "2632.0", "2428.0", "1868.0", "1949.0", "1725.0", "1611.0", "1203.0", "1051.0", "1052.0", "1005.0", "1005.0", "789.0", "726.0", "583.0", "541.0", "499.0", "386.0", "…
```

]

---

## Renaming made easy

.leftcol35[.noborder[.center[

`janitor::clean_names()`

&lt;center&gt;
&lt;img src="images/janitor_logo.png" width=200&gt;
&lt;/center&gt;

]]]

.rightcol65[


```r
*library(janitor)

wind &lt;- read_excel(here::here(
  'data', 'US_State_Wind_Energy_Facts_2018.xlsx')) %&gt;%
* clean_names(case = 'screaming_snake')

glimpse(wind)
```

```
#&gt; Rows: 50
#&gt; Columns: 7
#&gt; $ RANKING                   &lt;chr&gt; "1.0", "2.0", "3.0", "4.0", "5.0", "6.0", "7.0", "8.0", "9.0", "10.0", "11.0", "12.0", "13.0", "14.0", "15.0", "16.0", "17.0", "18.0", "19.0", "20.0", "21.0", "22.0", "23.0", "24.0", "25.0", "26.0", "27.0", "28.0",…
#&gt; $ STATE                     &lt;chr&gt; "TEXAS", "OKLAHOMA", "IOWA", "CALIFORNIA", "KANSAS", "ILLINOIS", "MINNESOTA", "OREGON", "COLORADO", "WASHINGTON", "NORTH DAKOTA", "INDIANA", "MICHIGAN", "NEW YORK", "NEW MEXICO", "WYOMING", "NEBRASKA", "PENNSYLVANI…
#&gt; $ INSTALLED_CAPACITY_MW     &lt;dbl&gt; 23262, 7495, 7312, 5686, 5110, 4464, 3699, 3213, 3106, 3075, 2996, 2117, 1904, 1829, 1682, 1489, 1445, 1369, 977, 973, 959, 923, 746, 720, 686, 617, 391, 268, 208, 206, 191, 185, 152, 149, 113, 62, 54, 29, 9, 5, 2,…
#&gt; $ EQUIVALENT_HOMES_POWERED  &lt;chr&gt; "6235000.0", "2268000.0", "1935000.0", "1298000.0", "1719000.0", "1050000.0", "1012000.0", "604600.0", "889100.0", "695300.0", "1021000.0", "440700.0", "471700.0", "366500.0", "422100.0", "408700.0", "486700.0", "3…
#&gt; $ TOTAL_INVESTMENT_MILLIONS &lt;chr&gt; "42000.0", "13700.0", "14200.0", "12600.0", "9400.0", "8900.0", "7100.0", "6600.0", "6000.0", "6100.0", "5800.0", "4500.0", "3500.0", "3700.0", "2900.0", "3100.0", "2600.0", "2800.0", "2100.0", "2100.0", "1800.0", …
#&gt; $ WIND_PROJECTS_ONLINE      &lt;dbl&gt; 136, 45, 107, 104, 35, 49, 98, 31, 25, 20, 28, 16, 26, 27, 17, 22, 22, 24, 14, 15, 8, 18, 18, 16, 6, 37, 5, 5, 1, 7, 6, 5, 1, 9, 44, 19, 15, 2, 2, 2, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0
#&gt; $ NUMBER_OF_WIND_TURBINES   &lt;chr&gt; "12750.0", "3717.0", "4145.0", "6972.0", "2795.0", "2632.0", "2428.0", "1868.0", "1949.0", "1725.0", "1611.0", "1203.0", "1051.0", "1052.0", "1005.0", "1005.0", "789.0", "726.0", "583.0", "541.0", "499.0", "386.0",…
```

]

---

### `select()`: more powerful than you probably thought

--

.leftcol60[.code70[

Example: data on sleeping patterns of different mammals


```r
glimpse(msleep)
```

```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ name         &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afri…
#&gt; $ genus        &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohyrax",…
#&gt; $ vore         &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", "herb…
#&gt; $ order        &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomorpha"…
#&gt; $ conservation &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domesticated",…
#&gt; $ sleep_total  &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 1…
#&gt; $ sleep_rem    &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.…
#&gt; $ sleep_cycle  &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA…
#&gt; $ awake        &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70, 16.0…
#&gt; $ brainwt      &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, N…
#&gt; $ bodywt       &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, …
```

]]

---

### `select()`: more powerful than you probably thought

.leftcol55[.code70[

Use `select()` to choose which columns to **keep**


```r
msleep %&gt;%
* select(name:order, sleep_total:sleep_cycle) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 7
#&gt; $ name        &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afric…
#&gt; $ genus       &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohyrax", …
#&gt; $ vore        &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", "herbi…
#&gt; $ order       &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomorpha",…
#&gt; $ sleep_total &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 12…
#&gt; $ sleep_rem   &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.9…
#&gt; $ sleep_cycle &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA,…
```

]]

--

.rightcol45[.code70[

Use `select()` to choose which columns to **drop**


```r
msleep %&gt;%
  select(-(name:order)) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 7
#&gt; $ conservation &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domesticated",…
#&gt; $ sleep_total  &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 1…
#&gt; $ sleep_rem    &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.…
#&gt; $ sleep_cycle  &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA…
#&gt; $ awake        &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70, 16.0…
#&gt; $ brainwt      &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, N…
#&gt; $ bodywt       &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, …
```

]]

---

## Select columns based on **partial column names**

--

.leftcol[.code70[

Select columns that start with "sleep":


```r
msleep %&gt;%
  select(name, starts_with("sleep")) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 4
#&gt; $ name        &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afric…
#&gt; $ sleep_total &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 12…
#&gt; $ sleep_rem   &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.9…
#&gt; $ sleep_cycle &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA,…
```

]]

--

.rightcol[.code70[

Select columns that contain "eep" and end with "wt":


```r
msleep %&gt;%
  select(contains("eep"), ends_with("wt")) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 5
#&gt; $ sleep_total &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 12…
#&gt; $ sleep_rem   &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.9…
#&gt; $ sleep_cycle &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA,…
#&gt; $ brainwt     &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, NA…
#&gt; $ bodywt      &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, 8…
```

]]

---

## Select columns based on their **data type**

.leftcol[

Select only numeric columns:


```r
msleep %&gt;%
    select_if(is.numeric) %&gt;%
    glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 6
#&gt; $ sleep_total &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 12…
#&gt; $ sleep_rem   &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.9…
#&gt; $ sleep_cycle &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA,…
#&gt; $ awake       &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70, 16.00…
#&gt; $ brainwt     &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, NA…
#&gt; $ bodywt      &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, 8…
```

]

--

.rightcol[

Select only character columns:


```r
msleep %&gt;%
    select_if(is.character) %&gt;%
    glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 5
#&gt; $ name         &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afri…
#&gt; $ genus        &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohyrax",…
#&gt; $ vore         &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", "herb…
#&gt; $ order        &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomorpha"…
#&gt; $ conservation &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domesticated",…
```

]

---

## Use `select()` to **reorder** variables

--

.leftcol45[.code70[


```r
msleep %&gt;%
    select(everything()) %&gt;%
    glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ name         &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afri…
#&gt; $ genus        &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohyrax",…
#&gt; $ vore         &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", "herb…
#&gt; $ order        &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomorpha"…
#&gt; $ conservation &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domesticated",…
#&gt; $ sleep_total  &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 1…
#&gt; $ sleep_rem    &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.…
#&gt; $ sleep_cycle  &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA…
#&gt; $ awake        &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70, 16.0…
#&gt; $ brainwt      &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, N…
#&gt; $ bodywt       &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, …
```

]]

--

.rightcol55[.code70[


```r
msleep %&gt;%
    select(conservation, awake, everything()) %&gt;%
    glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ conservation &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domesticated",…
#&gt; $ awake        &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70, 16.0…
#&gt; $ name         &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", "Afri…
#&gt; $ genus        &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohyrax",…
#&gt; $ vore         &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", "herb…
#&gt; $ order        &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomorpha"…
#&gt; $ sleep_total  &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12.8, 1…
#&gt; $ sleep_rem    &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, NA, 0.…
#&gt; $ sleep_cycle  &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, NA, NA…
#&gt; $ brainwt      &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.00500, N…
#&gt; $ bodywt       &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.995, …
```

]]

---

## Use `select()` to **rename** variables

--

.leftcol[.code70[

Use `rename()` to just change the name


```r
msleep %&gt;%
* rename(
    animal = name,
    extinction_threat = conservation) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ animal            &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", …
#&gt; $ genus             &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohy…
#&gt; $ vore              &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", …
#&gt; $ order             &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomo…
#&gt; $ extinction_threat &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domestica…
#&gt; $ sleep_total       &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12…
#&gt; $ sleep_rem         &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, N…
#&gt; $ sleep_cycle       &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, N…
#&gt; $ awake             &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70,…
#&gt; $ brainwt           &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.005…
#&gt; $ bodywt            &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.…
```

]]

--

.rightcol[.code70[

Use `select()` to change the name **and drop everything else**


```r
msleep %&gt;%
* select(
    animal = name,
    extinction_threat = conservation) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 2
#&gt; $ animal            &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", …
#&gt; $ extinction_threat &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domestica…
```

]]

---

## Use `select()` to **rename** variables

.leftcol[.code70[

Use `rename()` to just change the name


```r
msleep %&gt;%
* rename(
    animal = name,
    extinction_threat = conservation) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ animal            &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", …
#&gt; $ genus             &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohy…
#&gt; $ vore              &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", …
#&gt; $ order             &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomo…
#&gt; $ extinction_threat &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domestica…
#&gt; $ sleep_total       &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12…
#&gt; $ sleep_rem         &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, N…
#&gt; $ sleep_cycle       &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, N…
#&gt; $ awake             &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70,…
#&gt; $ brainwt           &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.005…
#&gt; $ bodywt            &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.…
```

]]

.rightcol[.code70[

Use `select()` + `everything()` to change names **and keep everything else**


```r
msleep %&gt;%
* select(
    animal = name,
    extinction_threat = conservation,
*   everything()) %&gt;%
  glimpse()
```

```
#&gt; Rows: 83
#&gt; Columns: 11
#&gt; $ animal            &lt;chr&gt; "Cheetah", "Owl monkey", "Mountain beaver", "Greater short-tailed shrew", "Cow", "Three-toed sloth", "Northern fur seal", "Vesper mouse", "Dog", "Roe deer", "Goat", "Guinea pig", "Grivet", "Chinchilla", "Star-nosed mole", …
#&gt; $ extinction_threat &lt;chr&gt; "lc", NA, "nt", "lc", "domesticated", NA, "vu", NA, "domesticated", "lc", "lc", "domesticated", "lc", "domesticated", "lc", NA, "lc", "lc", "lc", "lc", "en", "lc", "domesticated", "domesticated", "lc", "lc", NA, "domestica…
#&gt; $ genus             &lt;chr&gt; "Acinonyx", "Aotus", "Aplodontia", "Blarina", "Bos", "Bradypus", "Callorhinus", "Calomys", "Canis", "Capreolus", "Capri", "Cavis", "Cercopithecus", "Chinchilla", "Condylura", "Cricetomys", "Cryptotis", "Dasypus", "Dendrohy…
#&gt; $ vore              &lt;chr&gt; "carni", "omni", "herbi", "omni", "herbi", "herbi", "carni", NA, "carni", "herbi", "herbi", "herbi", "omni", "herbi", "omni", "omni", "omni", "carni", "herbi", "omni", "herbi", "insecti", "herbi", "herbi", "omni", "omni", …
#&gt; $ order             &lt;chr&gt; "Carnivora", "Primates", "Rodentia", "Soricomorpha", "Artiodactyla", "Pilosa", "Carnivora", "Rodentia", "Carnivora", "Artiodactyla", "Artiodactyla", "Rodentia", "Primates", "Rodentia", "Soricomorpha", "Rodentia", "Soricomo…
#&gt; $ sleep_total       &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1, 3.0, 5.3, 9.4, 10.0, 12.5, 10.3, 8.3, 9.1, 17.4, 5.3, 18.0, 3.9, 19.7, 2.9, 3.1, 10.1, 10.9, 14.9, 12.5, 9.8, 1.9, 2.7, 6.2, 6.3, 8.0, 9.5, 3.3, 19.4, 10.1, 14.2, 14.3, 12…
#&gt; $ sleep_rem         &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0.6, 0.8, 0.7, 1.5, 2.2, 2.0, 1.4, 3.1, 0.5, 4.9, NA, 3.9, 0.6, 0.4, 3.5, 1.1, NA, 3.2, 1.1, 0.4, 0.1, 1.5, 0.6, 1.9, 0.9, NA, 6.6, 1.2, 1.9, 3.1, NA, 1.4, 2.0, NA, NA, 0.9, N…
#&gt; $ sleep_cycle       &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.3833333, NA, 0.3333333, NA, NA, 0.2166667, NA, 0.1166667, NA, NA, 0.1500000, 0.3833333, NA, 0.3333333, NA, 0.1166667, 1.0000000, NA, 0.2833333, NA, NA, 0.4166667, 0.5500000, N…
#&gt; $ awake             &lt;dbl&gt; 11.90, 7.00, 9.60, 9.10, 20.00, 9.60, 15.30, 17.00, 13.90, 21.00, 18.70, 14.60, 14.00, 11.50, 13.70, 15.70, 14.90, 6.60, 18.70, 6.00, 20.10, 4.30, 21.10, 20.90, 13.90, 13.10, 9.10, 11.50, 14.20, 22.10, 21.35, 17.80, 17.70,…
#&gt; $ brainwt           &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0.07000, 0.09820, 0.11500, 0.00550, NA, 0.00640, 0.00100, 0.00660, 0.00014, 0.01080, 0.01230, 0.00630, 4.60300, 0.00030, 0.65500, 0.41900, 0.00350, 0.11500, NA, 0.02560, 0.005…
#&gt; $ bodywt            &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.490, 0.045, 14.000, 14.800, 33.500, 0.728, 4.750, 0.420, 0.060, 1.000, 0.005, 3.500, 2.950, 1.700, 2547.000, 0.023, 521.000, 187.000, 0.770, 10.000, 0.071, 3.300, 0.200, 899.…
```

]]

---

class: inverse

<div class="countdown" id="timer_ef0cbfdd" data-warn-when="15" data-update-every="1" tabindex="0" style="top:0;right:0;font-size:2em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">15</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

.leftcol40[

## Your turn

Read in the `hot_dog_winners.xlsx` file and adjust the variable names and types to the following:


```
#&gt; Rows: 42
#&gt; Columns: 7
#&gt; $ year              &lt;dbl&gt; 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, …
#&gt; $ competitor.mens   &lt;chr&gt; "Paul Siederman &amp; Joe Baldini", "Thomas DeBerry", "Steven Abrams", "Luis Llamas", "Birgit Felden", "Oscar Rodriguez", "Mark Heller", "Don Wolfman", "Jay Green", "Jay Green", "Mike DeVito", "Frank Dellarosa", "Frank Dellaro…
#&gt; $ competitor.womens &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Sonya Thomas", "Sonya Thomas", "Sonya Thomas", "Miki Sudo", "Miki Sudo", "Miki Sudo", "Miki Sudo"…
#&gt; $ dogs_eaten.mens   &lt;dbl&gt; 9.10, 11.00, 11.00, 19.50, 9.50, 11.75, 15.50, 12.00, 14.00, 13.00, 16.00, NA, 19.00, 17.00, 20.00, 19.50, NA, NA, 19.00, 20.25, NA, NA, NA, 44.50, NA, 49.00, NA, NA, 59.00, NA, 54.00, 62.00, 68.00, NA, 61.00, 62.00, NA, N…
#&gt; $ dogs_eaten.womens &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 36.75, 34.00, 38.00, 38.50, 41.00, 37.00, 31.00, NA, NA
#&gt; $ country.mens      &lt;chr&gt; "United States", "United States", "United States", "Mexico", "Germany", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States…
#&gt; $ country.womens    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "United States", "United States", "United States", "United States", "United States", "United State…
```

]

.rightcol60[

&lt;center&gt;
&lt;img src="images/hot_dogs.png" width=500&gt;
&lt;/center&gt;

]

---

class: inverse

# Quiz 3

<div class="countdown" id="timer_2393475f" data-warn-when="30" data-update-every="1" tabindex="0" style="bottom:0;left:0;font-size:4em;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

.leftcol[

### Link is in the #class channel

]

.rightcol[

&lt;center&gt;
&lt;img src="https://github.com/emse-p4a-gwu/2022-Spring/raw/main/images/quiz_doge.png" width="400"&gt;
&lt;/center&gt;

]

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. Merging datasets with joins
### 2. Are your variables the right _type_?
### 3. Are your variables the right _name_?

### QUIZ 1

### 4. .orange[Re-coding variables]
### 5. Dates
### 6. Dealing with messy Excel files

---

# Recoding with `ifelse()`

.leftcol35[

Example: Create a variable, `cost_high`, that is `TRUE` if the repair costs were greater than the median costs and `FALSE` otherwise.

]

.rightcol65[.code70[


```r
wildlife_impacts1 &lt;- wildlife_impacts %&gt;%
  rename(cost = cost_repairs_infl_adj) %&gt;%
  filter(!is.na(cost)) %&gt;%
  mutate(
    cost_median = median(cost),
*   cost_high = ifelse(cost &gt; cost_median, TRUE, FALSE))

wildlife_impacts1 %&gt;%
  select(cost, cost_median, cost_high) %&gt;%
  head()
```

```
#&gt; # A tibble: 6 × 3
#&gt;     cost cost_median cost_high
#&gt;    &lt;dbl&gt;       &lt;dbl&gt; &lt;lgl&gt;    
#&gt; 1   1000       26783 FALSE    
#&gt; 2    200       26783 FALSE    
#&gt; 3  10000       26783 FALSE    
#&gt; 4 100000       26783 TRUE     
#&gt; 5  20000       26783 FALSE    
#&gt; 6 487000       26783 TRUE
```

]]

---

## Recoding with **nested** `ifelse()`

.leftcol35[

Create a variable, `season`, based on the `incident_month` variable.

]

.rightcol65[.code70[


```r
wildlife_impacts2 &lt;- wildlife_impacts %&gt;%
* mutate(season = ifelse(
*   incident_month %in% c(3, 4, 5), 'spring', ifelse(
*   incident_month %in% c(6, 7, 8), 'summer', ifelse(
*   incident_month %in% c(9, 10, 11), 'fall', 'winter')))
* )

wildlife_impacts2 %&gt;%
  distinct(incident_month, season) %&gt;%
  head()
```

```
#&gt; # A tibble: 6 × 2
#&gt;   incident_month season
#&gt;            &lt;dbl&gt; &lt;chr&gt; 
#&gt; 1             12 winter
#&gt; 2             11 fall  
#&gt; 3             10 fall  
#&gt; 4              9 fall  
#&gt; 5              8 summer
#&gt; 6              7 summer
```

]]

---

## Recoding with `case_when()`

.leftcol35[

Create a variable, `season`, based on the `incident_month` variable.

**Note**: If you don't include the final `TRUE ~ 'winter'` condition, you'll get `NA` for those cases.

]

.rightcol65[.code70[


```r
wildlife_impacts2 &lt;- wildlife_impacts %&gt;%
* mutate(season = case_when(
*   incident_month %in% c(3, 4, 5) ~ 'spring',
*   incident_month %in% c(6, 7, 8) ~ 'summer',
*   incident_month %in% c(9, 10, 11) ~ 'fall',
*   TRUE ~ 'winter')
* )

wildlife_impacts2 %&gt;%
  distinct(incident_month, season) %&gt;%
  head()
```

```
#&gt; # A tibble: 6 × 2
#&gt;   incident_month season
#&gt;            &lt;dbl&gt; &lt;chr&gt; 
#&gt; 1             12 winter
#&gt; 2             11 fall  
#&gt; 3             10 fall  
#&gt; 4              9 fall  
#&gt; 5              8 summer
#&gt; 6              7 summer
```

]]

---

## Recoding with `case_when()` with `between()`

.leftcol35[

Create a variable, `season`, based on the `incident_month` variable.

]

.rightcol65[.code70[


```r
wildlife_impacts2 &lt;- wildlife_impacts %&gt;%
  mutate(season = case_when(
*   between(incident_month, 3, 5) ~ 'spring',
*   between(incident_month, 6, 8) ~ 'summer',
*   between(incident_month, 9, 11) ~ 'fall',
    TRUE ~ 'winter')
  )

wildlife_impacts2 %&gt;%
    distinct(incident_month, season) %&gt;%
    head()
```

```
#&gt; # A tibble: 6 × 2
#&gt;   incident_month season
#&gt;            &lt;dbl&gt; &lt;chr&gt; 
#&gt; 1             12 winter
#&gt; 2             11 fall  
#&gt; 3             10 fall  
#&gt; 4              9 fall  
#&gt; 5              8 summer
#&gt; 6              7 summer
```

]]

---

## `case_when()` is "cleaner" than `ifelse()`

--

Convert the `num_engs` variable into a word of the number.

.leftcol55[.code70[

`ifelse()`


```r
wildlife_impacts3 &lt;- wildlife_impacts %&gt;%
  mutate(num_engs = ifelse(
    num_engs == 1, 'one', ifelse(
    num_engs == 2, 'two', ifelse(
    num_engs == 3, 'three', ifelse(
    num_engs == 4, 'four',
    as.character(num_engs)))))
  )

unique(wildlife_impacts3$num_engs)
```

```
#&gt; [1] "two"   NA      "three" "four"  "one"
```

]]

--

.rightcol45[.code70[

`case_when()`


```r
wildlife_impacts3 &lt;- wildlife_impacts %&gt;%
  mutate(num_engs = case_when(
    num_engs == 1 ~ 'one',
    num_engs == 2 ~ 'two',
    num_engs == 3 ~ 'three',
    num_engs == 4 ~ 'four')
  )

unique(wildlife_impacts3$num_engs)
```

```
#&gt; [1] "two"   NA      "three" "four"  "one"
```

]]

---

## Break a single variable into two with `separate()`

.leftcol40[


```r
tb_rates
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country      year rate             
#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan  1999 745/19987071     
#&gt; 2 Afghanistan  2000 2666/20595360    
#&gt; 3 Brazil       1999 37737/172006362  
#&gt; 4 Brazil       2000 80488/174504898  
#&gt; 5 China        1999 212258/1272915272
#&gt; 6 China        2000 213766/1280428583
```

]

--

.rightcol60[


```r
tb_rates %&gt;%
* separate(rate, into = c("cases", "population"))
```

```
#&gt; # A tibble: 6 × 4
#&gt;   country      year cases  population
#&gt;   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
#&gt; 1 Afghanistan  1999 745    19987071  
#&gt; 2 Afghanistan  2000 2666   20595360  
#&gt; 3 Brazil       1999 37737  172006362 
#&gt; 4 Brazil       2000 80488  174504898 
#&gt; 5 China        1999 212258 1272915272
#&gt; 6 China        2000 213766 1280428583
```

]

---

## Break a single variable into two with `separate()`

.leftcol40[


```r
tb_rates
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country      year rate             
#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan  1999 745/19987071     
#&gt; 2 Afghanistan  2000 2666/20595360    
#&gt; 3 Brazil       1999 37737/172006362  
#&gt; 4 Brazil       2000 80488/174504898  
#&gt; 5 China        1999 212258/1272915272
#&gt; 6 China        2000 213766/1280428583
```

]

.rightcol60[


```r
tb_rates %&gt;%
  separate(rate, into = c("cases", "population"),
*          sep = "/")
```

```
#&gt; # A tibble: 6 × 4
#&gt;   country      year cases  population
#&gt;   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
#&gt; 1 Afghanistan  1999 745    19987071  
#&gt; 2 Afghanistan  2000 2666   20595360  
#&gt; 3 Brazil       1999 37737  172006362 
#&gt; 4 Brazil       2000 80488  174504898 
#&gt; 5 China        1999 212258 1272915272
#&gt; 6 China        2000 213766 1280428583
```

]

---

## Break a single variable into two with `separate()`

.leftcol40[


```r
tb_rates
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country      year rate             
#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan  1999 745/19987071     
#&gt; 2 Afghanistan  2000 2666/20595360    
#&gt; 3 Brazil       1999 37737/172006362  
#&gt; 4 Brazil       2000 80488/174504898  
#&gt; 5 China        1999 212258/1272915272
#&gt; 6 China        2000 213766/1280428583
```

]

.rightcol60[


```r
tb_rates %&gt;%
  separate(rate, into = c("cases", "population"),
           sep = "/", 
*          convert = TRUE)
```

```
#&gt; # A tibble: 6 × 4
#&gt;   country      year  cases population
#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
#&gt; 1 Afghanistan  1999    745   19987071
#&gt; 2 Afghanistan  2000   2666   20595360
#&gt; 3 Brazil       1999  37737  172006362
#&gt; 4 Brazil       2000  80488  174504898
#&gt; 5 China        1999 212258 1272915272
#&gt; 6 China        2000 213766 1280428583
```

]

---

## You can also break up a variable by an index

.leftcol40[


```r
tb_rates
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country      year rate             
#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan  1999 745/19987071     
#&gt; 2 Afghanistan  2000 2666/20595360    
#&gt; 3 Brazil       1999 37737/172006362  
#&gt; 4 Brazil       2000 80488/174504898  
#&gt; 5 China        1999 212258/1272915272
#&gt; 6 China        2000 213766/1280428583
```

]

.rightcol60[


```r
tb_rates %&gt;%
* separate(year, into = c("century", "year"),
*          sep = 2)
```

```
#&gt; # A tibble: 6 × 4
#&gt;   country     century year  rate             
#&gt;   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan 19      99    745/19987071     
#&gt; 2 Afghanistan 20      00    2666/20595360    
#&gt; 3 Brazil      19      99    37737/172006362  
#&gt; 4 Brazil      20      00    80488/174504898  
#&gt; 5 China       19      99    212258/1272915272
#&gt; 6 China       20      00    213766/1280428583
```

]

---

## `unite()`: The opposite of `separate()`

.leftcol40[


```r
tb_rates
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country      year rate             
#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan  1999 745/19987071     
#&gt; 2 Afghanistan  2000 2666/20595360    
#&gt; 3 Brazil       1999 37737/172006362  
#&gt; 4 Brazil       2000 80488/174504898  
#&gt; 5 China        1999 212258/1272915272
#&gt; 6 China        2000 213766/1280428583
```

]

.rightcol60[


```r
tb_rates %&gt;%
  separate(year, into = c("century", "year"),
           sep = 2) %&gt;%
* unite(year_new, century, year)
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country     year_new rate             
#&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;            
#&gt; 1 Afghanistan 19_99    745/19987071     
#&gt; 2 Afghanistan 20_00    2666/20595360    
#&gt; 3 Brazil      19_99    37737/172006362  
#&gt; 4 Brazil      20_00    80488/174504898  
#&gt; 5 China       19_99    212258/1272915272
#&gt; 6 China       20_00    213766/1280428583
```

]

---

## `unite()`: The opposite of `separate()`

.leftcol40[


```r
tb_rates
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country      year rate             
#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
#&gt; 1 Afghanistan  1999 745/19987071     
#&gt; 2 Afghanistan  2000 2666/20595360    
#&gt; 3 Brazil       1999 37737/172006362  
#&gt; 4 Brazil       2000 80488/174504898  
#&gt; 5 China        1999 212258/1272915272
#&gt; 6 China        2000 213766/1280428583
```

]

.rightcol60[


```r
tb_rates %&gt;%
  separate(year, into = c("century", "year"),
           sep = 2) %&gt;%
  unite(year_new, century, year,
*       sep = "")
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country     year_new rate             
#&gt;   &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;            
#&gt; 1 Afghanistan 1999     745/19987071     
#&gt; 2 Afghanistan 2000     2666/20595360    
#&gt; 3 Brazil      1999     37737/172006362  
#&gt; 4 Brazil      2000     80488/174504898  
#&gt; 5 China       1999     212258/1272915272
#&gt; 6 China       2000     213766/1280428583
```

]

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. Merging datasets with joins
### 2. Are your variables the right _type_?
### 3. Are your variables the right _name_?

### QUIZ 1

### 4. Re-coding variables
### 5. .orange[Dates]
### 6. Dealing with messy Excel files

---

class: inverse, middle, center

&lt;center&gt;
&lt;img src="images/dates.png" width=600&gt;
&lt;center&gt;

---

### Create dates from strings - **order is the ONLY thing that matters!**

--

.cols3[

.center[Year-Month-Day]


```r
ymd('2020-02-26')
```

```
#&gt; [1] "2020-02-26"
```
]

---

### Create dates from strings - **order is the ONLY thing that matters!**

.cols3[

.center[Year-Month-Day]


```r
ymd('2020-02-26')
```

```
#&gt; [1] "2020-02-26"
```

```r
ymd('2020 Feb 26')
```

```
#&gt; [1] "2020-02-26"
```

]

---

### Create dates from strings - **order is the ONLY thing that matters!**

.cols3[

.center[Year-Month-Day]


```r
ymd('2020-02-26')
```

```
#&gt; [1] "2020-02-26"
```

```r
ymd('2020 Feb 26')
```

```
#&gt; [1] "2020-02-26"
```

```r
ymd('2020 Feb. 26')
```

```
#&gt; [1] "2020-02-26"
```

```r
ymd('2020 february 26')
```

```
#&gt; [1] "2020-02-26"
```

]

--

.cols3[

.center[Month-Day-Year]


```r
mdy('February 26, 2020')
```

```
#&gt; [1] "2020-02-26"
```

```r
mdy('Feb. 26, 2020')
```

```
#&gt; [1] "2020-02-26"
```

```r
mdy('Feb 26 2020')
```

```
#&gt; [1] "2020-02-26"
```

]

--

.cols3[

.center[Day-Month-Year]


```r
dmy('26 February 2020')
```

```
#&gt; [1] "2020-02-26"
```

```r
dmy('26 Feb. 2020')
```

```
#&gt; [1] "2020-02-26"
```

```r
dmy('26 Feb, 2020')
```

```
#&gt; [1] "2020-02-26"
```

]

---

class: center, middle

# Check out the `lubridate` **[cheat sheet](https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf)**

---

## Extracting information from dates

.code60[


```r
date &lt;- today()
date
```

```
#&gt; [1] "2022-09-12"
```

]

--

.leftcol[.code60[


```r
# Get the year
year(date)
```

```
#&gt; [1] 2022
```

]]

---

## Extracting information from dates

.code60[


```r
date &lt;- today()
date
```

```
#&gt; [1] "2022-09-12"
```

]

.leftcol[.code60[


```r
# Get the year
year(date)
```

```
#&gt; [1] 2022
```

```r
# Get the month
month(date)
```

```
#&gt; [1] 9
```

```r
# Get the month name
month(date, label = TRUE, abbr = FALSE)
```

```
#&gt; [1] September
#&gt; Levels: January &lt; February &lt; March &lt; April &lt; May &lt; June &lt; July &lt; August &lt; September &lt; October &lt; November &lt; December
```

]]

--

.rightcol[.code60[


```r
# Get the day
day(date)
```

```
#&gt; [1] 12
```

```r
# Get the weekday
wday(date)
```

```
#&gt; [1] 2
```

```r
# Get the weekday name
wday(date, label = TRUE, abbr = TRUE)
```

```
#&gt; [1] Mon
#&gt; Levels: Sun &lt; Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat
```

]]

---
class: inverse

# Quick practice

On what day of the week were you born?

.leftcol60[


```r
wday("2020-02-26", label = TRUE)
```

```
#&gt; [1] Wed
#&gt; Levels: Sun &lt; Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat
```

]

---

## Modifying date elements


```r
date &lt;- today()
date
```

```
#&gt; [1] "2022-09-12"
```

--


```r
# Change the year
year(date) &lt;- 2016
date
```

```
#&gt; [1] "2016-09-12"
```

--


```r
# Change the day
day(date) &lt;- 30
```

--


```r
date
```

```
#&gt; [1] "2016-09-30"
```

---

class: inverse

# Quick practice

What do you think will happen if we do this?


```r
date &lt;- ymd("2022-02-28")
day(date) &lt;- 30
```

--


```r
date
```

```
#&gt; [1] "2022-03-02"
```

---

class: inverse

.leftcol[.font80[

### Your turn

1) Use `case_when()` to modify the `phase_of_flt` variable in the `wildlife_impacts` data:

- The values `'approach'`, `'arrival'`, `'descent'`, and `'landing roll'` should be merged into a single value called `'arrival'`.
- The values `'climb'`, `'departure'`,  and `'take-off run'` should be merged into a single value called `'departure'`.
- All other values should be called `'other'`.

Before:

.code70[


```r
unique(str_to_lower(wildlife_impacts$phase_of_flt))
```

```
#&gt;  [1] "climb"        "landing roll" NA             "approach"     "take-off run" "departure"    "arrival"      "descent"      "local"        "taxi"         "unknown"      "en route"     "parked"
```
After:

```
#&gt; [1] "departure" "arrival"   "other"
```

]]]

--

.rightcol[.font80[

<div class="countdown" id="timer_a4514a18" data-warn-when="30" data-update-every="15" data-blink-colon="true" tabindex="0" style="right:0;bottom:0;font-size:1.5em;position: relative; width: min-content;&#10;             display: block; margin-left: 300px;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">20</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

2) Use the **lubridate** package to create a new variable, `weekday_name`, from the `incident_date` variable in the `wildlife_impacts` data.

3) Use `weekday_name` and `phase_of_flt` to make this plot of "arrival" and "departure" impacts from **Mar. 2016**.

&lt;img src="figs/unnamed-chunk-97-1.png" width="648" style="display: block; margin: auto;" /&gt;
]]

---



class: inverse, middle

# Week 3: .fancy[Cleaning Data]

### 1. Merging datasets with joins
### 2. Are your variables the right _type_?
### 3. Are your variables the right _name_?

### QUIZ 1

### 4. Re-coding variables
### 5. Dates
### 6. .orange[Dealing with messy Excel files]

---

.leftcol40[

## When columns are repeated

Example: Winners of Nathan's hot dog eating contest

## Stragies

#### 1. Divide &amp; conquer
#### 2. Gather, separate, spread

]

.rightcol60[.center[

&lt;center&gt;
&lt;img src="images/hot_dogs.png" width=500&gt;
&lt;/center&gt;

]]

---

## Strategy 1: divide &amp; conquer

.leftcol40[

Steps:

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table

]

.rightcol60[


```r
hot_dogs &lt;- read_excel(
    here::here('data', 'hot_dog_winners.xlsx'),
    sheet = 'hot_dog_winners') %&gt;%
    clean_names() %&gt;%
    dplyr::filter(!is.na(mens))

glimpse(hot_dogs)
```

```
#&gt; Rows: 40
#&gt; Columns: 7
#&gt; $ year         &lt;chr&gt; "1980", "1981", "1982", "1983", "1984", "1985", "1986", "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "20…
#&gt; $ mens         &lt;chr&gt; "Paul Siederman &amp; Joe Baldini", "Thomas DeBerry", "Steven Abrams", "Luis Llamas", "Birgit Felden", "Oscar Rodriguez", "Mark Heller", "Don Wolfman", "Jay Green", "Jay Green", "Mike DeVito", "Frank Dellarosa", "Frank Dellarosa", …
#&gt; $ dogs_eaten_3 &lt;chr&gt; "9.1", "11", "11", "19.5", "9.5", "11.75", "15.5", "12", "14", "13", "16", "21.5*", "19", "17", "20", "19.5", "22.25*", "24.5*", "19", "20.25", "25.13*", "50*", "50.5*", "44.5", "53.5*", "49", "53.75*", "66*", "59", "68*", "54"…
#&gt; $ country_4    &lt;chr&gt; "United States", "United States", "United States", "Mexico", "Germany", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "U…
#&gt; $ womens       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Sonya Thomas", "Sonya Thomas", "Sonya Thomas", "Miki Sudo", "Miki Sudo", "Miki Sudo", "Miki Sudo", "Mi…
#&gt; $ dogs_eaten_6 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "40*", "45*", "36.75", "34", "38", "38.5", "41", "37", "31"
#&gt; $ country_7    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "United States", "United States", "United States", "United States", "United States", "United States", "…
```

]

---

## Strategy 1: divide &amp; conquer

.leftcol40[

Steps

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table
4. **Split data into two competitions with the same variable names**
5. **Create new variable in each data frame: `competition`**

]

.rightcol60[


```r
hot_dogs_m &lt;- hot_dogs %&gt;%
    select(
        year,
        competitor = mens,
        dogs_eaten = dogs_eaten_3,
        country    = country_4) %&gt;%
*   mutate(competition = 'Mens')

hot_dogs_w &lt;- hot_dogs %&gt;%
    select(
        year,
        competitor = womens,
        dogs_eaten = dogs_eaten_6,
        country    = country_7) %&gt;%
*   mutate(competition = 'Womens') %&gt;%
    dplyr::filter(!is.na(competitor))
```

]

---

## Strategy 1: divide &amp; conquer

.leftcol40[

Steps

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table
4. Split data into two competitions with the same variable names
5. Create new variable in each data frame: `competition`
6. **Merge data together with `bind_rows()`**
7. **Clean up final data frame**

]

.rightcol60[


```r
*hot_dogs &lt;- bind_rows(hot_dogs_m, hot_dogs_w) %&gt;%
    mutate(
        new_record = str_detect(dogs_eaten, "\\*"),
        dogs_eaten = parse_number(dogs_eaten),
        year       = as.numeric(year))

glimpse(hot_dogs)
```

```
#&gt; Rows: 49
#&gt; Columns: 6
#&gt; $ year        &lt;dbl&gt; 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, …
#&gt; $ competitor  &lt;chr&gt; "Paul Siederman &amp; Joe Baldini", "Thomas DeBerry", "Steven Abrams", "Luis Llamas", "Birgit Felden", "Oscar Rodriguez", "Mark Heller", "Don Wolfman", "Jay Green", "Jay Green", "Mike DeVito", "Frank Dellarosa", "Frank Dellarosa", "…
#&gt; $ dogs_eaten  &lt;dbl&gt; 9.10, 11.00, 11.00, 19.50, 9.50, 11.75, 15.50, 12.00, 14.00, 13.00, 16.00, 21.50, 19.00, 17.00, 20.00, 19.50, 22.25, 24.50, 19.00, 20.25, 25.13, 50.00, 50.50, 44.50, 53.50, 49.00, 53.75, 66.00, 59.00, 68.00, 54.00, 62.00, 68.00,…
#&gt; $ country     &lt;chr&gt; "United States", "United States", "United States", "Mexico", "Germany", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "Un…
#&gt; $ competition &lt;chr&gt; "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Mens", "Men…
#&gt; $ new_record  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, TRUE, TRUE, FALSE, FALSE, TRUE, TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, TRUE, FALSE, TRUE, FALSE, FALSE, FALSE, TRUE, F…
```

]

---

.leftcol45[

&lt;img src="images/hot_dogs.png" width=500&gt;

]

.rightcol55[.code50[


```r
head(hot_dogs)
```

```
#&gt; # A tibble: 6 × 6
#&gt;    year competitor                   dogs_eaten country       competition new_record
#&gt;   &lt;dbl&gt; &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;lgl&gt;     
#&gt; 1  1980 Paul Siederman &amp; Joe Baldini        9.1 United States Mens        FALSE     
#&gt; 2  1981 Thomas DeBerry                     11   United States Mens        FALSE     
#&gt; 3  1982 Steven Abrams                      11   United States Mens        FALSE     
#&gt; 4  1983 Luis Llamas                        19.5 Mexico        Mens        FALSE     
#&gt; 5  1984 Birgit Felden                       9.5 Germany       Mens        FALSE     
#&gt; 6  1985 Oscar Rodriguez                    11.8 United States Mens        FALSE
```

]]

---

## Strategy 2: gather, separate, spread

.leftcol40[

Steps:

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table

]

.rightcol60[


```r
hot_dogs &lt;- read_excel(
    here::here('data', 'hot_dog_winners.xlsx'),
    sheet = 'hot_dog_winners') %&gt;%
    clean_names() %&gt;%
    dplyr::filter(!is.na(mens))

glimpse(hot_dogs)
```

```
#&gt; Rows: 40
#&gt; Columns: 7
#&gt; $ year         &lt;chr&gt; "1980", "1981", "1982", "1983", "1984", "1985", "1986", "1987", "1988", "1989", "1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "20…
#&gt; $ mens         &lt;chr&gt; "Paul Siederman &amp; Joe Baldini", "Thomas DeBerry", "Steven Abrams", "Luis Llamas", "Birgit Felden", "Oscar Rodriguez", "Mark Heller", "Don Wolfman", "Jay Green", "Jay Green", "Mike DeVito", "Frank Dellarosa", "Frank Dellarosa", …
#&gt; $ dogs_eaten_3 &lt;chr&gt; "9.1", "11", "11", "19.5", "9.5", "11.75", "15.5", "12", "14", "13", "16", "21.5*", "19", "17", "20", "19.5", "22.25*", "24.5*", "19", "20.25", "25.13*", "50*", "50.5*", "44.5", "53.5*", "49", "53.75*", "66*", "59", "68*", "54"…
#&gt; $ country_4    &lt;chr&gt; "United States", "United States", "United States", "Mexico", "Germany", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "United States", "U…
#&gt; $ womens       &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Sonya Thomas", "Sonya Thomas", "Sonya Thomas", "Miki Sudo", "Miki Sudo", "Miki Sudo", "Miki Sudo", "Mi…
#&gt; $ dogs_eaten_6 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "40*", "45*", "36.75", "34", "38", "38.5", "41", "37", "31"
#&gt; $ country_7    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "United States", "United States", "United States", "United States", "United States", "United States", "…
```

]

---

## Strategy 2: gather, separate, spread

.leftcol40[

Steps:

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table
4. **Rename variables**
5. **Gather all the "joint" variables**

]

.rightcol60[


```r
hot_dogs &lt;- hot_dogs %&gt;%
    select(
        year,
        competitor.mens   = mens,
        competitor.womens = womens,
        dogs_eaten.mens   = dogs_eaten_3,
        dogs_eaten.womens = dogs_eaten_6,
        country.mens      = country_4,
        country.womens    = country_7) %&gt;%
*   gather(key = 'variable', value = 'value',
*          competitor.mens:country.womens)

head(hot_dogs, 3)
```

```
#&gt; # A tibble: 3 × 3
#&gt;   year  variable        value                       
#&gt;   &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;                       
#&gt; 1 1980  competitor.mens Paul Siederman &amp; Joe Baldini
#&gt; 2 1981  competitor.mens Thomas DeBerry              
#&gt; 3 1982  competitor.mens Steven Abrams
```

]

---

## Strategy 2: gather, separate, spread

.leftcol30[

Steps:

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table
4. Rename variables
5. Gather all the "joint" variables
6. **Separate "joint" variables into components**

]

.rightcol70[


```r
hot_dogs &lt;- hot_dogs %&gt;%
*   separate(variable, into = c('variable', 'competition'),
*            sep = '\\.')

head(hot_dogs)
```

```
#&gt; # A tibble: 6 × 4
#&gt;   year  variable   competition value                       
#&gt;   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;                       
#&gt; 1 1980  competitor mens        Paul Siederman &amp; Joe Baldini
#&gt; 2 1981  competitor mens        Thomas DeBerry              
#&gt; 3 1982  competitor mens        Steven Abrams               
#&gt; 4 1983  competitor mens        Luis Llamas                 
#&gt; 5 1984  competitor mens        Birgit Felden               
#&gt; 6 1985  competitor mens        Oscar Rodriguez
```

]

---

## Strategy 2: gather, separate, spread

.leftcol30[

Steps:

1. Read in the data
2. Clean the names
3. Remove `*` note at bottom of table
4. Rename variables
5. Gather all the "joint" variables
6. Separate "joint" variables into components
7. **Spread variable and value back to columns**
8. **Clean up final data frame**

]

.rightcol70[


```r
hot_dogs &lt;- hot_dogs %&gt;%
*   spread(key = variable, value = value) %&gt;%
    mutate(
        new_record = str_detect(dogs_eaten, "\\*"),
        dogs_eaten = parse_number(dogs_eaten),
        year       = as.numeric(year))

glimpse(hot_dogs)
```

```
#&gt; Rows: 80
#&gt; Columns: 6
#&gt; $ year        &lt;dbl&gt; 1980, 1980, 1981, 1981, 1982, 1982, 1983, 1983, 1984, 1984, 1985, 1985, 1986, 1986, 1987, 1987, 1988, 1988, 1989, 1989, 1990, 1990, 1991, 1991, 1992, 1992, 1993, 1993, 1994, 1994, 1995, 1995, 1996, 1996, 1997, 1997, 1998, 1998, …
#&gt; $ competition &lt;chr&gt; "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "womens", "mens", "wom…
#&gt; $ competitor  &lt;chr&gt; "Paul Siederman &amp; Joe Baldini", NA, "Thomas DeBerry", NA, "Steven Abrams", NA, "Luis Llamas", NA, "Birgit Felden", NA, "Oscar Rodriguez", NA, "Mark Heller", NA, "Don Wolfman", NA, "Jay Green", NA, "Jay Green", NA, "Mike DeVito",…
#&gt; $ country     &lt;chr&gt; "United States", NA, "United States", NA, "United States", NA, "Mexico", NA, "Germany", NA, "United States", NA, "United States", NA, "United States", NA, "United States", NA, "United States", NA, "United States", NA, "United St…
#&gt; $ dogs_eaten  &lt;dbl&gt; 9.10, NA, 11.00, NA, 11.00, NA, 19.50, NA, 9.50, NA, 11.75, NA, 15.50, NA, 12.00, NA, 14.00, NA, 13.00, NA, 16.00, NA, 21.50, NA, 19.00, NA, 17.00, NA, 20.00, NA, 19.50, NA, 22.25, NA, 24.50, NA, 19.00, NA, 20.25, NA, 25.13, NA,…
#&gt; $ new_record  &lt;lgl&gt; FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, TRUE, NA, FALSE, NA, FALSE, NA, FALSE, NA, FALSE, NA, TRUE, NA, TRUE, NA, FALSE, NA, FALSE, NA, TRUE, NA, T…
```

]

---

.leftcol[.code60[

Divide &amp; conquer


```r
hot_dogs &lt;- read_excel(
    here::here('data', 'hot_dog_winners.xlsx'),
    sheet = 'hot_dog_winners') %&gt;%
    clean_names() %&gt;%
    dplyr::filter(!is.na(mens))

*# Divide
*hot_dogs_m &lt;- hot_dogs %&gt;%
*   select(
*       year,
*       competitor = mens,
*       dogs_eaten = dogs_eaten_3,
*       country    = country_4) %&gt;%
*   mutate(competition = 'Mens')
*hot_dogs_w &lt;- hot_dogs %&gt;%
*   select(
*       year,
*       competitor = womens,
*       dogs_eaten = dogs_eaten_6,
*       country    = country_7) %&gt;%
*   mutate(competition = 'Womens') %&gt;%
*   dplyr::filter(!is.na(competitor))

# Merge and finish cleaning
*hot_dogs &lt;- bind_rows(hot_dogs_m, hot_dogs_w) %&gt;%
    mutate(
        new_record = str_detect(dogs_eaten, "\\*"),
        dogs_eaten = parse_number(dogs_eaten),
        year       = as.numeric(year))
```

]]

.rightcol[.code60[

Gather, separate, spread


```r
hot_dogs &lt;- read_excel(
    here::here('data', 'hot_dog_winners.xlsx'),
    sheet = 'hot_dog_winners') %&gt;%
    clean_names() %&gt;%
    dplyr::filter(!is.na(mens)) %&gt;%

*   # Rename variables
*   select(
*       year,
*       competitor.mens   = mens,
*       competitor.womens = womens,
*       dogs_eaten.mens   = dogs_eaten_3,
*       dogs_eaten.womens = dogs_eaten_6,
*       country.mens      = country_4,
*       country.womens    = country_7) %&gt;%
*   # Gather "joint" variables
*   gather(key = 'variable', value = 'value',
*          competitor.mens:country.womens) %&gt;%
*   # Separate "joint" variables
*   separate(variable, into = c('variable', 'competition'),
*            sep = '\\.') %&gt;%
*   # Spread "joint" variables
*   spread(key = variable, value = value) %&gt;%
    # Finish cleaning
    mutate(
        new_record = str_detect(dogs_eaten, "\\*"),
        dogs_eaten = parse_number(dogs_eaten),
        year       = as.numeric(year))
```

]]

---

.leftcol30[

## Strategies for dealing with **sub-headers**

&lt;br&gt;

Example:

OICA passenger car sales data

]

.rightcol70[.center[

&lt;br&gt;
&lt;center&gt;
&lt;img src="images/pc_sales.png" width=800&gt;
&lt;/center&gt;

]]

---

## Strategies for dealing with sub-headers

.leftcol40[

Steps:

1. Read in the data, skipping first 5 rows
2. Clean the names

]

.rightcol60[


```r
pc_sales &lt;- read_excel(
    here::here('data', 'pc_sales_2018.xlsx'),
*   sheet = 'pc_sales', skip = 5) %&gt;%
    clean_names() %&gt;%
    rename(country = regions_countries)

glimpse(pc_sales)
```

```
#&gt; Rows: 160
#&gt; Columns: 18
#&gt; $ country &lt;chr&gt; NA, "EUROPE", "EU 28 countries + EFTA", "EU 15 countries + EFTA", "AUSTRIA", "BELGIUM", "DENMARK", "FINLAND", "FRANCE", "GERMANY", "GREECE", "ICELAND", "IRELAND", "ITALY", "LUXEMBOURG", "NETHERLANDS", "NORWAY", "PORTUGAL", "SPAIN", …
#&gt; $ x2      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
#&gt; $ x3      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
#&gt; $ x4      &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
#&gt; $ x2005   &lt;dbl&gt; NA, 17906455, 15622035, 14565695, 307915, 480088, 148819, 148161, 2118042, 3319259, 269728, 18060, 171742, 2244108, 48517, 465196, 109907, 206488, 1528877, 274301, 266770, 2439717, 1056340, 25956, 70541, 17687, 151699, 19640, 198982…
#&gt; $ x2006   &lt;dbl&gt; NA, 18685556, 15961138, 14820182, 308594, 526141, 156936, 145700, 2045745, 3467961, 267669, 17129, 178484, 2335462, 50837, 483999, 109164, 194702, 1634608, 282766, 269421, 2344864, 1140956, 36455, 78775, 18639, 156686, 25363, 187676…
#&gt; $ x2007   &lt;dbl&gt; NA, 19618588, 16147274, 14842186, 298182, 524795, 162686, 125608, 2109672, 3148163, 279745, 15942, 186325, 2494115, 51332, 504300, 129195, 201816, 1614835, 306794, 284674, 2404007, 1305088, 43521, 82664, 22878, 174456, 30912, 171661…
#&gt; $ x2008   &lt;dbl&gt; NA, 18821599, 14911880, 13602038, 293697, 535947, 150199, 139669, 2091369, 3090040, 267295, 9033, 151607, 2161359, 52359, 499980, 110617, 213389, 1161176, 253982, 288525, 2131795, 1309842, 45143, 88265, 22241, 182554, 24579, 153278,…
#&gt; $ x2009   &lt;dbl&gt; NA, 16608761, 14533115, 13668808, 319403, 476194, 112454, 90574, 2302398, 3807175, 219730, 2113, 57453, 2159465, 47265, 387699, 98675, 161013, 952772, 213408, 266018, 1994999, 864307, 22869, 44918, 14981, 167708, 9946, 60189, 7515, …
#&gt; $ x2010   &lt;dbl&gt; NA, 16499863, 13830694, 12984549, 328563, 547340, 153858, 111968, 2251669, 2916259, 141501, 3106, 88446, 1961580, 49726, 482531, 127754, 223464, 982015, 289684, 294239, 2030846, 846145, 16257, 38587, 14088, 169580, 10295, 43476, 797…
#&gt; $ x2011   &lt;dbl&gt; NA, 17167600, 13642659, 12815435, 356145, 572211, 170036, 126123, 2204229, 3173634, 97680, 5038, 89911, 1749740, 49881, 555812, 138345, 153404, 808051, 304984, 318958, 1941253, 827224, 19250, 41561, 13480, 173595, 17070, 45094, 1323…
#&gt; $ x2012   &lt;dbl&gt; NA, 16191269, 12567903, 11773281, 336010, 486737, 170763, 111251, 1898760, 3082504, 58482, 7902, 79498, 1403010, 50398, 502454, 137967, 95309, 699589, 279899, 328139, 2044609, 794622, 19419, 31360, 10123, 174009, 19424, 53059, 10665…
#&gt; $ x2013   &lt;dbl&gt; NA, 15942273, 12344415, 11555153, 319035, 486065, 182086, 103455, 1790456, 2952431, 58694, 7274, 74367, 1304648, 46624, 417036, 142151, 105921, 722689, 269599, 307885, 2264737, 789262, 19352, 27802, 7102, 164736, 19694, 56139, 10636…
#&gt; $ x2014   &lt;dbl&gt; NA, 16154279, 13061461, 12148648, 303318, 482939, 189055, 106237, 1795885, 3036773, 71218, 9537, 96284, 1360578, 49793, 387553, 144202, 142826, 890125, 303948, 301942, 2476435, 912813, 20359, 33962, 8276, 192314, 20969, 67476, 12452…
#&gt; $ x2015   &lt;dbl&gt; NA, 16410563, 14287881, 13261258, 308555, 501066, 207717, 108819, 1917226, 3206042, 75805, 14004, 124804, 1575737, 46473, 449350, 150686, 178503, 1094077, 345108, 323783, 2633503, 1026623, 23500, 35715, 10344, 230857, 20347, 77171, …
#&gt; $ x2016   &lt;dbl&gt; NA, 17291819, 15160239, 13971468, 329604, 539519, 222924, 118991, 2015177, 3351607, 78873, 18442, 146600, 1824968, 50561, 382825, 154603, 207345, 1147007, 372318, 317318, 2692786, 1188771, 26370, 44106, 12643, 259693, 22429, 96552, …
#&gt; $ x2017   &lt;dbl&gt; NA, 17974281, 15631283, 14320223, 353320, 546558, 221821, 120480, 2110748, 3441262, 88083, 21324, 131332, 1970497, 52775, 414306, 158650, 222129, 1234932, 379393, 311996, 2540617, 1311060, 33265, 50769, 13127, 271595, 25618, 116265,…
#&gt; $ x2018   &lt;dbl&gt; NA, 17912336, 15626509, 14210016, 341068, 549632, 218566, 120480, 2173481, 3435778, 103431, 17976, 125557, 1910025, 52786, 443531, 147929, 228327, 1321438, 353729, 299135, 2367147, 1416493, 37506, 60041, 13135, 261437, 26297, 136601…
```

]

---

## Strategies for dealing with sub-headers

.leftcol30[

Steps:

1. Read in the data, skipping first 5 rows
2. Clean the names
3. **Drop bad columns**
4. **Filter out bad rows**

&lt;br&gt;

Use **datapasta** to get rows to drop

]

.rightcol70[


```r
drop &lt;- c(
    'EUROPE', 'EU 28 countries + EFTA',
    'EU 15 countries + EFTA', 'EUROPE NEW MEMBERS',
    'RUSSIA, TURKEY &amp; OTHER EUROPE', 'AMERICA',
    'NAFTA', 'CENTRAL &amp; SOUTH AMERICA',
    'ASIA/OCEANIA/MIDDLE EAST', 'AFRICA', 'ALL COUNTRIES')

pc_sales &lt;- pc_sales %&gt;%
    select(-c(x2:x4)) %&gt;%       # Drop bad columns
*   filter(! country %in% drop, # Drop bad rows
           ! is.na(country))

head(pc_sales)
```

```
#&gt; # A tibble: 6 × 15
#&gt;   country   x2005   x2006   x2007   x2008   x2009   x2010   x2011   x2012   x2013   x2014   x2015   x2016   x2017   x2018
#&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 AUSTRIA  307915  308594  298182  293697  319403  328563  356145  336010  319035  303318  308555  329604  353320  341068
#&gt; 2 BELGIUM  480088  526141  524795  535947  476194  547340  572211  486737  486065  482939  501066  539519  546558  549632
#&gt; 3 DENMARK  148819  156936  162686  150199  112454  153858  170036  170763  182086  189055  207717  222924  221821  218566
#&gt; 4 FINLAND  148161  145700  125608  139669   90574  111968  126123  111251  103455  106237  108819  118991  120480  120480
#&gt; 5 FRANCE  2118042 2045745 2109672 2091369 2302398 2251669 2204229 1898760 1790456 1795885 1917226 2015177 2110748 2173481
#&gt; 6 GERMANY 3319259 3467961 3148163 3090040 3807175 2916259 3173634 3082504 2952431 3036773 3206042 3351607 3441262 3435778
```

]

---

## Strategies for dealing with sub-headers

.leftcol30[

Steps:

1. Read in the data, skipping first 5 rows
2. Clean the names
3. Drop bad columns
4. Filter out bad rows
5. **Gather the year variables**

]

.rightcol70[


```r
pc_sales &lt;- pc_sales %&gt;%
*   gather(key = 'year', value = 'num_cars', x2005:x2018)

head(pc_sales)
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country year  num_cars
#&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
#&gt; 1 AUSTRIA x2005   307915
#&gt; 2 BELGIUM x2005   480088
#&gt; 3 DENMARK x2005   148819
#&gt; 4 FINLAND x2005   148161
#&gt; 5 FRANCE  x2005  2118042
#&gt; 6 GERMANY x2005  3319259
```

]

---

## Strategies for dealing with sub-headers

.leftcol30[

Steps:

1. Read in the data, skipping first 5 rows
2. Clean the names
3. Drop bad columns
4. Filter out bad rows
5. Gather the year variables
6. **Separate the "x" from the year**

]

.rightcol70[


```r
pc_sales &lt;- pc_sales %&gt;%
*   separate(year, into = c('drop', 'year'), sep = 'x',
*            convert = TRUE)

head(pc_sales)
```

```
#&gt; # A tibble: 6 × 4
#&gt;   country drop   year num_cars
#&gt;   &lt;chr&gt;   &lt;lgl&gt; &lt;int&gt;    &lt;dbl&gt;
#&gt; 1 AUSTRIA NA     2005   307915
#&gt; 2 BELGIUM NA     2005   480088
#&gt; 3 DENMARK NA     2005   148819
#&gt; 4 FINLAND NA     2005   148161
#&gt; 5 FRANCE  NA     2005  2118042
#&gt; 6 GERMANY NA     2005  3319259
```

]

---

## Strategies for dealing with sub-headers

.leftcol30[

Steps:

1. Read in the data, skipping first 5 rows
2. Clean the names
3. Drop bad columns
4. Filter out bad rows
5. Gather the year variables
6. Separate the "x" from the year
7. **Remove the `drop` column**
8. **Finish cleaning**

]

.rightcol70[


```r
pc_sales &lt;- pc_sales %&gt;%
* select(-drop) %&gt;%
  mutate(country  = str_to_title(country))

head(pc_sales)
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country  year num_cars
#&gt;   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;
#&gt; 1 Austria  2005   307915
#&gt; 2 Belgium  2005   480088
#&gt; 3 Denmark  2005   148819
#&gt; 4 Finland  2005   148161
#&gt; 5 France   2005  2118042
#&gt; 6 Germany  2005  3319259
```

]

---

class: middle, center

# What if I wanted to keep the continents?

--

### Strategy: Join a new data frame linking country -&gt; continent

---

.code70[


```r
drop &lt;- c(
  'EUROPE', 'EU 28 countries + EFTA',
  'EU 15 countries + EFTA', 'EUROPE NEW MEMBERS',
  'RUSSIA, TURKEY &amp; OTHER EUROPE', 'AMERICA',
  'NAFTA', 'CENTRAL &amp; SOUTH AMERICA',
  'ASIA/OCEANIA/MIDDLE EAST', 'AFRICA', 'ALL COUNTRIES')

pc_sales &lt;- read_excel(
  here::here('data', 'pc_sales_2018.xlsx'),
  sheet = 'pc_sales', skip = 5) %&gt;%
  clean_names() %&gt;%
  rename(country = regions_countries) %&gt;% 
  select(-c(x2:x4)) %&gt;%       # Drop bad columns
  filter(! country %in% drop, # Drop bad rows
         ! is.na(country)) %&gt;% 
  gather(key = 'year', value = 'num_cars', x2005:x2018) %&gt;%
  separate(year, into = c('drop', 'year'), sep = 'x',
           convert = TRUE) %&gt;% 
  select(-drop)

head(pc_sales, 3)
```

```
#&gt; # A tibble: 3 × 3
#&gt;   country  year num_cars
#&gt;   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt;
#&gt; 1 AUSTRIA  2005   307915
#&gt; 2 BELGIUM  2005   480088
#&gt; 3 DENMARK  2005   148819
```

]

---

## Strategy 1: Find another source

## Strategy 2: Hand-make it

--

.leftcol[


```r
pc_regions &lt;- read_csv(here::here(
  "data", "pc_regions.csv"))

head(pc_regions)
```

```
#&gt; # A tibble: 6 × 3
#&gt;   country region subregion             
#&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;                 
#&gt; 1 AUSTRIA EUROPE EU 15 countries + EFTA
#&gt; 2 BELGIUM EUROPE EU 15 countries + EFTA
#&gt; 3 DENMARK EUROPE EU 15 countries + EFTA
#&gt; 4 FINLAND EUROPE EU 15 countries + EFTA
#&gt; 5 FRANCE  EUROPE EU 15 countries + EFTA
#&gt; 6 GERMANY EUROPE EU 15 countries + EFTA
```

]

--

.rightcol[


```r
pc_sales &lt;- pc_sales %&gt;% 
* left_join(pc_regions)

head(pc_sales)
```

```
#&gt; # A tibble: 6 × 5
#&gt;   country  year num_cars region subregion             
#&gt;   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;                 
#&gt; 1 AUSTRIA  2005   307915 EUROPE EU 15 countries + EFTA
#&gt; 2 BELGIUM  2005   480088 EUROPE EU 15 countries + EFTA
#&gt; 3 DENMARK  2005   148819 EUROPE EU 15 countries + EFTA
#&gt; 4 FINLAND  2005   148161 EUROPE EU 15 countries + EFTA
#&gt; 5 FRANCE   2005  2118042 EUROPE EU 15 countries + EFTA
#&gt; 6 GERMANY  2005  3319259 EUROPE EU 15 countries + EFTA
```

]

---

.leftcol[

&lt;img src="images/pc_sales.png" width=800&gt;

]

.rightcol[

.code50[


```r
drop &lt;- c(
  'EUROPE', 'EU 28 countries + EFTA',
  'EU 15 countries + EFTA', 'EUROPE NEW MEMBERS',
  'RUSSIA, TURKEY &amp; OTHER EUROPE', 'AMERICA',
  'NAFTA', 'CENTRAL &amp; SOUTH AMERICA',
  'ASIA/OCEANIA/MIDDLE EAST', 'AFRICA', 'ALL COUNTRIES')

pc_regions &lt;- read_csv(here::here("data", "pc_regions.csv"))

pc_sales &lt;- read_excel(
  here::here('data', 'pc_sales_2018.xlsx'),
  sheet = 'pc_sales', skip = 5) %&gt;%
  clean_names() %&gt;%
  rename(country = regions_countries) %&gt;% 
  select(-c(x2:x4)) %&gt;%       # Drop bad columns
  filter(! country %in% drop, # Drop bad rows
         ! is.na(country)) %&gt;% 
  gather(key = 'year', value = 'num_cars', x2005:x2018) %&gt;%
  separate(year, into = c('drop', 'year'), sep = 'x',
           convert = TRUE) %&gt;% 
  select(-drop) %&gt;% 
  left_join(pc_regions) %&gt;% 
  mutate(
    country  = str_to_title(country), 
    region  = str_to_title(region), 
    subregion  = str_to_title(subregion))

head(pc_sales)
```

```
#&gt; # A tibble: 6 × 5
#&gt;   country  year num_cars region subregion             
#&gt;   &lt;chr&gt;   &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;                 
#&gt; 1 Austria  2005   307915 Europe Eu 15 Countries + Efta
#&gt; 2 Belgium  2005   480088 Europe Eu 15 Countries + Efta
#&gt; 3 Denmark  2005   148819 Europe Eu 15 Countries + Efta
#&gt; 4 Finland  2005   148161 Europe Eu 15 Countries + Efta
#&gt; 5 France   2005  2118042 Europe Eu 15 Countries + Efta
#&gt; 6 Germany  2005  3319259 Europe Eu 15 Countries + Efta
```

]]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
